<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>EDW Client Test Page</title>
</head>
<body>
    <div id="app">
    </div>
<script type="text/javascript">
    window.onload = function() {
        EdwClient.enableLogging(true);

        EdwClient.stackFrameAllow(['grp1', 'page1'])
        .then(t => EdwClient.getOrCreateConfig({ 
            //TODO: Specify grp1 or config storage
            r1: 'EDA8BF65-C8CF-4B86-8BB1-81EE66F80ED2',
            r2: '2229C87C-E640-4909-85A6-BFABA3DD99BE'
        }))
        .then(t => EdwClient.getOrCreateRs(EdwClient.RsTypes.Immediate, 'r1', {}))
        .then(t => EdwClient.setStackFrame('grp1', {
            page: 'page1',
            pageOrder: 'page+'
        }))
        .then(t => EdwClient.setStackFrame('page1', {
            a: 1,
            b: 2
        }))
        .then(t => EdwClient.addEvent(['r1'], {
            splash: 's1',
            impression: 1
        }))

        /*************************PAGE 2********************************/
        .then(t => EdwClient.stackFrameAllow(['grp1', 'page2']))
        .then(t => EdwClient.getOrCreateConfig({ 
            //TODO: Specify grp1 or config storage
            r1: 'EDA8BF65-C8CF-4B86-8BB1-81EE66F80ED2',
            r2: '2229C87C-E640-4909-85A6-BFABA3DD99BE'
        }))
        .then(t => EdwClient.getOrCreateRs(EdwClient.RsTypes.Immediate, 'r1', {}))
        .then(t => EdwClient.setStackFrame('grp1', {
            page: 'page2',
            pageOrder: 'page+'
        }))
        .then(t => EdwClient.setStackFrame('page2', {
            c: 3,
            d: 4
        }))
        .then(t => EdwClient.addEvent(['r1'], {
            splash: 's1',
            impression: 1
        }))

        /*************************SURVEY********************************/
        .then(t => EdwClient.stackFrameAllow(['grp1', 'survey']))
        .then(t => EdwClient.getOrCreateConfig({ 
            //TODO: Specify grp1 or config storage
            r1: 'EDA8BF65-C8CF-4B86-8BB1-81EE66F80ED2',
            r2: '2229C87C-E640-4909-85A6-BFABA3DD99BE'
        }))
        .then(t => EdwClient.getOrCreateRs(EdwClient.RsTypes.Immediate, 'r1', {}))
        .then(t => EdwClient.setStackFrame('grp1', {
            page: 'survey',
            pageOrder: 'page+'
        }))
        .then(t => EdwClient.setStackFrame('survey', {
            surveyId: 'American'
        }))
        .then(t => EdwClient.addEvent(['r1'], {
            splash: 's1',
            impression: 1
        }))

        /*************************SURVEY********************************/
        .then(t => EdwClient.stackFrameAllow(['grp1', 'survey', 'question']))
        .then(t => EdwClient.getOrCreateConfig({ 
            //TODO: Specify grp1 or config storage
            r1: 'EDA8BF65-C8CF-4B86-8BB1-81EE66F80ED2',
            r2: '2229C87C-E640-4909-85A6-BFABA3DD99BE'
        }))
        .then(t => EdwClient.getOrCreateRs(EdwClient.RsTypes.Immediate, 'r1', {}))
        .then(t => EdwClient.setStackFrame('grp1', {
            page: 'question',
            pageOrder: 'page+'
        }))
        .then(t => EdwClient.setStackFrame('question', {
            questionId: 10
        }))
        .then(t => EdwClient.addEvent(['r1'], {
            splash: 's1',
            impression: 1
        }))

        /*************************SURVEY********************************/
        .then(t => EdwClient.stackFrameAllow(['grp1', 'survey', 'question', 'answer']))
        .then(t => EdwClient.getOrCreateConfig({ 
            //TODO: Specify grp1 or config storage
            r1: 'EDA8BF65-C8CF-4B86-8BB1-81EE66F80ED2',
            r2: '2229C87C-E640-4909-85A6-BFABA3DD99BE'
        }))
        .then(t => EdwClient.getOrCreateRs(EdwClient.RsTypes.Immediate, 'r1', {}))
        .then(t => EdwClient.setStackFrame('grp1', {
            page: 'question',
            pageOrder: 'page+'
        }))
        .then(t => EdwClient.setStackFrame('answer', {
            answer: 'An hypothetic answer.'
        }))
        .then(t => EdwClient.addEvent(['r1'], {
            splash: 's1',
            impression: 1
        }))
        
        .catch(reason => console.log('Error! Reason: ' + reason));
    }
</script>
</body>
</html>